---
// src/pages/blog/[slug].astro

import { getEntry, getCollection } from 'astro:content';
import Layout from '../../layouts/BaseLayout.astro';

const { slug } = Astro.params;

// This assumes your MDX file is named `vibing.mdx`, so the id is 'vibing'
const entry = await getEntry({ collection: 'blog', id: slug });

if (!entry) throw new Error(`No blog post found for slug: ${slug}`);

const { data, Component } = entry;

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.id }, // NOT post.slug
  }));
}

---

<Layout title={data.title}>
  <article class="prose dark:prose-invert max-w-prose mx-auto">
    <h1 class="text-3xl font-bold text-shell">{data.title}</h1>
    <p class="italic text-night/70 dark:text-ivory/70 mt-2">{data.description}</p>
    <hr class="my-6 border-night/10 dark:border-ivory/20" />

    {Component ? <Component /> : <p class="text-red-500">MDX component failed to load.</p>}
  </article>
</Layout>
